# 计算机网络

协议：是计算机之间的为了实现正常通信产生的交流规则

##**OSI协议**（七层协议）

==应用层==：给应用程序提供服务的协议，比如**HTTP（超文本传输协议）、DNS（域名系统）、FTP（文件传输协议）、SMTP（简单邮件传输协议等）都是属于应用层协议**、，我们把应用层交互的数据单元称为报文

==表示层==：设备的数据格式和网络标准数据格式的转换，数据加密解密、压缩和解压缩，比如在项目开发中，为了方便数据传输，可以使用`base64`对数据进行编解码。

==会话层==：建立、管理和维护会话通信，该层的通信由不同设备中的应用程序之间的服务请求和响应组成。在项目开发中，我们经常要使用`cookie/session/token`来进行会话状态保持。如果没错的话`cookie/session/token`应该是工作在会话层的。**SSL（安全套接字协议）/ TLS（传输层安全协议）、RPC远程过程调用协议**

==传输层==：建立、管理和维护端到端之间的连接。建立了主机端到端的链接，传输层的作用是为上层协议提供端到端的可靠和**透明的数据传输**服务，包括处理**差错控制**和流量控制等问题。该层向高层屏蔽了下层数据通信的细节，使高层用户看到的只是在两个传输实体间的一条主机到主机的、可由用户控制和设定的、可靠的数据通路。我们通常说的，`TCP` `UDP`就是在这一层。端口号既是这里的“端”。**TCP、UDP 则属于传输层协议**

==网络层==：IP选址和路由选择，由哪个路由传递到目标地址。在发送数据时，网络层把运输层产生的报文段或用户数据报封装成分组和包进行传送。在 TCP/IP 体系结构中，由于网络层使用 **IP 协议**，因此分组也叫 **IP 数据报** ，简称 **数据报**。**IP协议 属于网络层协议**

==数据链路层==：提供介质访问和链路管理。将比特组合成字节,再将字节组合成帧,使用链路层地址 (以太网使用MAC地址)来访问介质,并进行差错检测。

==物理层==：在传输媒体上传送比特流。

![五层体系结构](https://my-blog-to-use.oss-cn-beijing.aliyuncs.com/2019/7/%E4%BA%94%E5%B1%82%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84.png)

## 五层协议

（1）**应用层**：应用层协议定义的是应用进程之间通信和交互规则，这里的进程指的是正在运行的程序。

（2）**运输层**：负责向两台主机中进程之间的通信提供通用的数据传输服务，主要协议有传输控制协议（TCP）、用户数据报协议（UDP）

（3）**网络层**：将运输层产生的报文段或用户数据报封装成分组或包进行传送。选择合适的路由，将源主机运输层所传下来的分组，通过网络中的路由的转发，到达目的地。

（4）**数据链路层**：计算机网络是由主机、路由器和连接他们的链路组成。数据链路层就是将分组从链路的一端传送到另外一端。这个层以帧为数据单元来传送。帧里面有同步信息、差错控制

（5）**物理层**：在传输媒体上传送比特流。

## HTTP HTTPS区别

(1) HTTP 是超文本传输协议，信息是明文传输，存在安全风险的问题。HTTPS 则解决 HTTP 不安全 的缺陷，在 TCP 和 HTTP 网络层之间加入了 SSL/TLS 安全协议，使得报文能够加密传输。

(2) HTTP 连接建立相对简单， TCP 三次握手之后便可进行 HTTP 的报文传输。而 HTTPS 在 TCP 三次握手之后，还需进行 SSL/TLS 的握手过程，才可进入加密报文传输。

(3) HTTP 的端口号是 80，HTTPS 的端口号是 443。

(4) HTTPS 协议需要向 CA（证书权威机构）申请数字证书，来保证服务器的身份是可信的。

## 对称加密和非对称加密

- 对称加密：密钥只有一个，加密解密为同一个密码，且加解密速度快，典型的对称加密算法有DES、AES等；
- 非对称加密：密钥成对出现（且根据公钥无法推知私钥，根据私钥也无法推知公钥），加密解密使用不同密钥（公钥加密需要私钥解密，私钥加密需要公钥解密），相对对称加密速度较慢，典型的非对称加密算法有RSA、DSA等。

## http1.0 http1.1 http1.2

HTTP1.0最早在网页中使用是在1996年，那个时候只是使用一些较为简单的网页上和网络请求上，而HTTP1.1则在1999年才开始广泛应用于现在的各大浏览器网络请求中，同时HTTP1.1也是当前使用最为广泛的HTTP协议。 主要区别主要体现在：

1. **长连接** : **在HTTP/1.0中，默认使用的是短连接**，也就是说每次请求都要重新建立一次连接。HTTP 是基于TCP/IP协议的,每一次建立或者断开连接都需要三次握手四次挥手的开销，如果每次请求都要这样的话，开销会比较大。因此最好能维持一个长连接，可以用个长连接来发多个请求。**HTTP 1.1起，默认使用长连接** ,默认开启Connection： keep-alive。 **HTTP/1.1的持续连接有非流水线方式和流水线方式** 。流水线方式是客户在收到HTTP的响应报文之前就能接着发送新的请求报文。与之相对应的非流水线方式是客户在收到前一个响应后才能发送下一个请求。
2. **错误状态响应码** :在HTTP1.1中新增了24个错误状态响应码，如409（Conflict）表示请求的资源与资源的当前状态发生冲突；410（Gone）表示服务器上的某个资源被永久性的删除。
3. **缓存处理** :在HTTP1.0中主要使用header里的If-Modified-Since,Expires来做为缓存判断的标准，HTTP1.1则引入了更多的缓存控制策略例如Entity tag，If-Unmodified-Since, If-Match, If-None-Match等更多可供选择的缓存头来控制缓存策略。
4. **带宽优化及网络连接的使用** :HTTP1.0中，存在一些浪费带宽的现象，例如客户端只是需要某个对象的一部分，而服务器却将整个对象送过来了，并且不支持断点续传功能，HTTP1.1则在请求头引入了range头域，它允许只请求资源的某个部分，即返回码是206（Partial Content），这样就方便了开发者自由的选择以便于充分利用带宽和连接。

## http状态码

- HTTP状态码分类：

| 分类 | 分类描述                                         |
| :--- | :----------------------------------------------- |
| 1**  | 提示信息，服务器收到请求，需要请求者继续执行操作 |
| 2**  | 成功，操作被成功接收并处理                       |
| 3**  | 重定向，需要进一步的操作以完成请求               |
| 4**  | 客户端错误，请求包含语法错误或无法完成请求       |
| 5**  | 服务器错误，服务器在处理请求的过程中发生了错误   |

* HTTP状态码列表:

| 状态码  | 状态码英文名称                  | 中文描述                                                     |
| :------ | :------------------------------ | :----------------------------------------------------------- |
| 100     | Continue                        | 继续。[客户端](http://www.dreamdu.com/webbuild/client_vs_server/)应继续其请求 |
| 101     | Switching Protocols             | 切换协议。服务器根据客户端的请求切换协议。只能切换到更高级的协议，例如，切换到HTTP的新版本协议 |
|         |                                 |                                                              |
| **200** | **OK**                          | **请求成功。一般用于GET与POST请求**                          |
| 201     | Created                         | 已创建。成功请求并创建了新的资源                             |
| 202     | Accepted                        | 已接受。已经接受请求，但未处理完成                           |
| 203     | Non-Authoritative Information   | 非授权信息。请求成功。但返回的meta信息不在原始的服务器，而是一个副本 |
| **204** | **No Content**                  | **无内容。服务器成功处理，但未返回内容。在未更新网页的情况下，可确保浏览器继续显示当前文档** |
| 205     | Reset Content                   | 重置内容。服务器处理成功，用户终端（例如：浏览器）应重置文档视图。可通过此返回码清除浏览器的表单域 |
| **206** | **Partial Content**             | **部分内容。服务器成功处理了部分GET请求**(是应用于 HTTP 分块下载或断点续传，表示响应返回的 body 数据并不是资源 的全部，而是其中的一部分，也是服务器处理成功的状态。) |
|         |                                 |                                                              |
| 300     | Multiple Choices                | 多种选择。请求的资源可包括多个位置，相应可返回一个资源特征与地址的列表用于用户终端（例如：浏览器）选择 |
| **301** | **Moved Permanently**           | **永久移动。请求的资源已被永久的移动到新URI，返回信息会包括新的URI，浏览器会自动定向到新URI。今后任何新的请求都应使用新的URI代替** |
| **302** | **Found**                       | **临时移动。与301类似。但资源只是临时被移动。客户端应继续使用原有URI** |
| 303     | See Other                       | 查看其它地址。与301类似。使用GET和POST请求查看               |
| **304** | **Not Modified**                | **未修改。所请求的资源未修改，服务器返回此状态码时，不会返回任何资源。客户端通常会缓存访问过的资源，通过提供一个头信息指出客户端希望只返回在指定日期之后修改的资源** |
| 305     | Use Proxy                       | 使用代理。所请求的资源必须通过代理访问                       |
| 306     | Unused                          | 已经被废弃的HTTP状态码                                       |
| 307     | Temporary Redirect              | 临时重定向。与302类似。使用GET请求重定向                     |
|         |                                 |                                                              |
| **400** | **Bad Request**                 | **表示客户端请求的报文有错误，服务器无法理解**               |
| 401     | Unauthorized                    | 请求要求用户的身份认证                                       |
| 402     | Payment Required                | 保留，将来使用                                               |
| **403** | **Forbidden**                   | **服务器理解请求客户端的请求，但是拒绝执行此请求**           |
| **404** | **Not Found**                   | **表示请求的资源在服务器上不存在或未找到，所以无法提供给客户端。** |
| 405     | Method Not Allowed              | 客户端请求中的方法被禁止                                     |
| 406     | Not Acceptable                  | 服务器无法根据客户端请求的内容特性完成请求                   |
| 407     | Proxy Authentication Required   | 请求要求代理的身份认证，与401类似，但请求者应当使用代理进行授权 |
| 408     | Request Time-out                | 服务器等待客户端发送的请求时间过长，超时                     |
| 409     | Conflict                        | 服务器完成客户端的 PUT 请求时可能返回此代码，服务器处理请求时发生了冲突 |
| 410     | Gone                            | 客户端请求的资源已经不存在。410不同于404，如果资源以前有现在被永久删除了可使用410代码，网站设计人员可通过301代码指定资源的新位置 |
| 411     | Length Required                 | 服务器无法处理客户端发送的不带Content-Length的请求信息       |
| 412     | Precondition Failed             | 客户端请求信息的先决条件错误                                 |
| 413     | Request Entity Too Large        | 由于请求的实体过大，服务器无法处理，因此拒绝请求。为防止客户端的连续请求，服务器可能会关闭连接。如果只是服务器暂时无法处理，则会包含一个Retry-After的响应信息 |
| 414     | Request-URI Too Large           | 请求的URI过长（URI通常为网址），服务器无法处理               |
| 415     | Unsupported Media Type          | 服务器无法处理请求附带的媒体格式                             |
| 416     | Requested range not satisfiable | 客户端请求的范围无效                                         |
| 417     | Expectation Failed              | 服务器无法满足Expect的请求头信息                             |
|         |                                 |                                                              |
| **500** | **Internal Server Error**       | **服务器内部错误，无法完成请求**                             |
| **501** | **Not Implemented**             | **服务器暂时不支持该请求的功能，无法完成请求，但是将来可能开放** |
| **502** | **Bad Gateway**                 | **作为网关或者代理工作的服务器尝试执行请求时，从远程服务器接收到了一个无效的响应**，通常是服务器作为网关或代理时返回的错误码，表示服务器自身工作正常，访问 后端服务器发生了错误。 |
| **503** | **Service Unavailable**         | **由于超载或系统维护，服务器暂时的无法处理客户端的请求**。延时的长度可包含在服务器的Retry-After头信息中 |
| 504     | Gateway Time-out                | 充当网关或代理的服务器，未及时从远端服务器获取请求           |
| 505     | HTTP Version not supported      | 服务器不支持请求的HTTP协议的版本，无法完成处理               |
